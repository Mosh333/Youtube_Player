<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
  <link rel="stylesheet" type="text/css" href="main.css">
  <link rel="stylesheet" type="text/css" href="slideshow.css">
  <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
  <script type="text/javascript" src="node_modules/materialize-css/dist/js/materialize.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <title>Youtube Player</title>
</head>
<body>
  <nav>
    <div class="nav-wrapper">
      <a href="#" class="brand-logo">Youtube Player</a>
      <ul id="nav-mobile" class="right">
        <li><a>Modify Playlist</a></li>
      </ul>
    </div>
  </nav>
  <div id="app_container">
<!--         <div class="your-class">
          <div><img src="http://78.media.tumblr.com/tumblr_m4i5j4V2171rtqthio1_500.jpg" height="200" width="200"></div>
          <div><img src="http://78.media.tumblr.com/tumblr_m32hleCOq61qjc1a7o1_1280.jpg" height="200" width="200"></div>
          <div><img src="http://78.media.tumblr.com/tumblr_lwl6mnLzRs1qze0hyo1_500.jpg" height="200" width="200"></div>
        </div>

        <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="other_modules/slick/slick.js"></script>
        <script type="text/javascript">
          $(document).ready(function(){
            $('.your-class').slick({
              dots: true,
              arrows: true,
              autoplay: true
            });
          });          
        </script> -->



        <script>
          var slideIndex = 1;
          showSlides(slideIndex);

          function plusSlides(n) {
            showSlides(slideIndex += n);
          }

          function currentSlide(n) {
            showSlides(slideIndex = n);
          }

          function showSlides(n) {
            var i;
            var slides = document.getElementsByClassName("mySlides");
            var dots = document.getElementsByClassName("dot");
            if (n > slides.length) {slideIndex = 1}    
              if (n < 1) {slideIndex = slides.length}
                for (i = 0; i < slides.length; i++) {
                  slides[i].style.display = "none";  
                }
                for (i = 0; i < dots.length; i++) {
                  dots[i].className = dots[i].className.replace(" active", "");
                }
                slides[slideIndex-1].style.display = "block";  
                dots[slideIndex-1].className += " active";
              }
            </script>

            <div class="row" id="changePlaylist">
              <div id="firstCol" class="col s5">
                <p></p>
                <label class="label-font">What Would You Like to Do?</label>
                <select id="selectOptions" class="browser-default">
                  <option value="" disabled selected>Choose your option</option>
                  <option value="1">Search a Video</option>
                  <option value="2">Play a Playlist</option>
                  <option value="3">Create/Modify Playlist</option>
                  <option value="4">Generate Playlist Text File</option>
                  <option value="5">If not hard, convert to MP3</option>
                </select>
                <script>
                  var temp = document.getElementById("selectOptions").addEventListener("change", redirect)

                  //console.log(temp);

                  function redirect(){
                      // console.log("Hello");  
                      // alert("Hello Worlds!")
                      if(this.value == 1){

                        //Here redirect to different html page
                        window.location = "searchVideo.html";
                      }else if(this.value == 2){

                        window.location = "playPlaylist.html";
                      }else if(this.value == 3){
                        //window.location = "changePlaylist.html";                        
                      }else if(this.value == 4){

                        window.location = "generateTxtFile.html";
                      }// }else if(this.value == 5){
                      //   
                      //   window.location = 
                      // }  
                    }

                  </script>
                  <p>Search Results:</p>

                  <nav>
                    <div id="searchBar" class="nav-wrapper">
                      <form>
                        <div class="input-field">
                          <input id="search" type="search" required placeholder="Search for a video..">
                          <label id="searchIcon" for="search"><i>&#x1F50D;</i></label>
                          <i class="material-icons">close</i>                   
                        </div>
                      </form>
                    </div>
                  </nav>
                  <div id="debug"></div>
                  <div id="debug2"></div>
                  <div id="debug3">
                    <ul id="searchList"></ul>
                  </div>
                  <div id="debug4"></div>
                  <div id="debug5"></div>
                  <div id="debug6"></div>
                  <div id="debug7"></div>
                  <div id="debug8"></div>
                  <div id="debug9"></div>
                <script>
                const node = document.getElementById("search");
                const the_app = document.getElementById("app_container");

                //Search for list of videos
                node.addEventListener("click", function(event){
                  var searchIcon = document.getElementById("searchIcon");
                  searchIcon.style.backgroundColor = "white";
                });
                the_app.addEventListener("click", function(event){
                  if(event.target.id != "search"){
                    var searchIcon = document.getElementById("searchIcon");
                    searchIcon.style.backgroundColor = "#C3B749";                       
                  }
                });

                node.addEventListener("keydown", function(event) {
                  if (event.key === "Enter") {
                        // alert(Hello);
                        event.preventDefault();
                        document.getElementById("debug").innerHTML = "Searching for: "+node.value;
                        const electron = require('electron');
                        const {ipcRenderer} = electron;
                        const makeButton = document.querySelector('button');

                        ipcRenderer.send('youtube:search', node.value); //like socket client to server
                      }
                    });
                //Cancel button functionality
                const cancelButton = document.getElementsByClassName("material-icons")[0]; //get second element of material-icons
                cancelButton.addEventListener("mousedown", function(event) {
                  document.getElementById("search").value = "";
                  document.getElementById("debug").innerHTML = "";
                });                
              </script>
              <ul id="searchListOld"></ul>
            </div>
            <div id="secondCol" class="col s7">
              <p></p>
              <div class="slideshow-container">

                <div class="mySlides fade">
                  <div class="numbertext">1 / 3</div>
                  <img src="http://78.media.tumblr.com/tumblr_lwl6mnLzRs1qze0hyo1_500.jpg" style="width:200px; height:200px;">
                  <div class="text">Caption Text</div>
                </div>

                <div class="mySlides fade">
                  <div class="numbertext">2 / 3</div>
                  <img src="http://78.media.tumblr.com/tumblr_m4i5j4V2171rtqthio1_500.jpg" style="width:200px; height:200px;">
                  <div class="text">Caption Two</div>
                </div>

                <div class="mySlides fade">
                  <div class="numbertext">3 / 3</div>
                  <img src="http://78.media.tumblr.com/tumblr_m32hleCOq61qjc1a7o1_1280.jpg" style="width:200px; height:200px;">
                  <div class="text">Caption Three</div>
                </div>

                <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                <a class="next" onclick="plusSlides(1)">&#10095;</a>

              </div>
              <br>

              <div style="text-align:center">
                <span class="dot" onclick="currentSlide(1)"></span> 
                <span class="dot" onclick="currentSlide(2)"></span> 
                <span class="dot" onclick="currentSlide(3)"></span> 
              </div>
              <div id="bottom_lower_half_container">
                <select id="selectOptions" class="browser-default">
                  <option value="" disabled selected>Choose your option</option>
                  <option value="1">Search a Video</option>
                  <option value="2">Play a Playlist</option>
                  <option value="3">Create/Modify Playlist</option>                
                  <option value="4">Generate Playlist Text File</option>
                  <option value="5">If not hard, convert to MP3</option>
                </select>
                <!-- <button id="button1" class="waves-effect waves-light btn">Make Playlist</button> -->

<!--                 <script>
                    const electron = require('electron');
                    const {ipcRenderer} = electron;
                    const makeButton = document.querySelector('button');

                    makeButton.addEventListener('click', myWriteFile);

                    function myWriteFile(e){
                        //const item = document.querySelector('#item').value;
                        link = "https://www.youtube.com/watch?v=5mQ1nLPt4vg"
                        ipcRenderer.send('item:write', "myFile.txt", link); //like socket client to server
                        alert("Hello World!");
                    }
                  </script> -->
                  <p>Test</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>
                  <p>Youtube Videos</p>                 
                </div>
              </div>
            </div>

            <!-- <ul></ul> -->
            <script>
              const electron = require('electron');
              const {ipcRenderer} = electron;
              const ul = document.querySelector('#searchListOld');

            //catch add item
            ipcRenderer.on('item:add', function(e,item){
              ul.className = "collection";
              const li = document.createElement('li');
              li.className = 'collection-item'
              const itemText = document.createTextNode(item);
              li.appendChild(itemText);
              ul.appendChild(li);
            });

            //catch clear item
            ipcRenderer.on('item:clear', function(e,item){
              ul.innerHTML = '';
              ul.className = '';
            });

            // ipcRenderer.on('youtube:searchHistory', function(e, searchHistory){
            //     //Create a DropDown Menu Here

            // });

            ipcRenderer.on('youtube:search', function(e,searchObj){
                //alert("Message received!");
                //document.getElementById("debug").innerHTML = "Message Received!";
                var myResultObj = JSON.stringify(searchObj, undefined, 2);
                //document.getElementById("debug2").innerHTML = "";

                //document.getElementById("debug2").innerHTML = searchObj.items;
                // document.getElementById("debug4").innerHTML = searchObj.items[0].etag;
                // document.getElementById("debug5").innerHTML = searchObj.items[9].snippet.title;
                // document.getElementById("debug6").innerHTML = searchObj.items[8].snippet.title;

                //Display List
                myVideoId = searchObj.items[0].id.videoId;
                for(var i = 0; i < searchObj.items.length; i++) {
                    var ul_searchList = document.querySelector('#searchList'); //debug3
                    ul_searchList.className = "collection";
                    var list_item = document.createElement('li');
                    var image_item = document.createElement('img');
                    var playArrow_item = document.createElement('a');

                    list_item.className = 'collection-item';
                    playArrow_item.className = 'red accent-4 btn-small';
                    playArrow_item.textContent = '▶';
                    playArrow_item.id = 'playButton'+i;

                    
                    //playArrow_item.textAlign = "right";
                    image_item.src = searchObj.items[i].snippet.thumbnails.default.url;                    
                    if(i==0){
                      ul_searchList.innerHTML = "";
                      ul_searchList.className = "";
                    }                    
                    var itemText = document.createTextNode(searchObj.items[i].snippet.title);
                    //var setPlayOptionCss = document.createTextNode('I will display &#9654;');                    
                    list_item.appendChild(image_item);
                    list_item.appendChild(itemText);
                    //playArrow_item.appendChild(setPlayOptionCss);
                    list_item.appendChild(playArrow_item);
                    ul_searchList.appendChild(list_item);

                    //Attach event after object created in DOM 
                    document.getElementById("playButton"+i).addEventListener("click",function(event) {
                        // const menu_options = document.getElementsByClassName("red accent-4 btn-small"); //get the play buttons
                        // menu_options.addEventListener("click",function(event){
                        //   alert("Hello World!");
                        // });
                        //Add dropdown menu here such as add to playlist1, 2, 3, 4, or remove from playlist
                        //when adding, this event function should use node.js via main.js to write to text file!                      
                        //Here we want to play the new video on click
                        //alert(this.id);
                        //alert(this.id.slice(-2));  //either two digit number or n#
                        var searchIndex = this.id.slice(-2);
                        if(searchIndex.includes('n')){ //chop off n
                          searchIndex = searchIndex.slice(-1);
                        }


                      });               
                  }
              });

            //Remove item
            ul.addEventListener('dblclick', removeItem);

            function removeItem(e){
              e.target.remove();
              if(ul.children.length == 0){
                ul.className = '';
              }
            }

          /* When the user clicks on the button, 
          toggle between hiding and showing the dropdown content */
          function toggleMenu(buttonNumber) {
              //buttonNumber is the id like "playbutton1" "playbutton2" etc
              var myButton = document.getElementById(this.buttonNumber);
              myButton.classList.toggle("show");
          }            


          </script>
        </div>
      </body>
      </html>